wizards:
  employee_onboarding:
    # Optional: Explicit module override (auto-resolved from FQCNs if omitted)
    module: hr
    
    # Basic metadata
    title: New Hire Onboarding
    description: Complete employee setup across personal, job, and document details
    icon: fas fa-user-plus
    
    # Wizard-level permissions (optional)
    permissions:
      - hr.manage_employees
      - hr.view_documents
    
    # Completion configuration
    completion:
      # Redirect after successful completion
      redirect: /hr/employees/{employee_id}
      
      # Success message with dynamic placeholders
      successMessage: "Welcome {{ employee.first_name }}! Onboarding completed successfully."
      
      # Post-completion actions
      actions:
        - type: send_email
          template: welcome_email
          to: employee.email
          subject: "Welcome to {{ company.name }}!"
          
        - type: create_task
          title: "Review new hire {{ employee.first_name }} {{ employee.last_name }}"
          description: "Please review the new hire's onboarding documents and setup."
          assignee: employee.manager_id
          due_date: "+3 days"
          
        - type: webhook
          url: https://slack.example.com/webhook
          payload:
            text: "New hire {{ employee.first_name }} has completed onboarding!"
            channel: "#hr-notifications"
    
    # Wizard steps (required)
    steps:
      # Step 1: Basic personal information
      - title: Personal Information
        description: Legal name and demographic information
        model: App\Modules\Hr\Models\Employee
        groups: [personal_information]
        
        # Step-level validation rules
        validation:
          required: true  # All fields in groups are required
          # OR granular field validation:
          # fields:
          #   first_name: required|string|max:255
          #   last_name: required|string|max:255
          #   email: "required|email|unique:employees,email"
        
        # Minimum/maximum entries (for repeatable steps)
        requiredEntry: 1  # 0 = optional, 1 = required, >1 = multiple entries required
        
        # Wizard-specific fields (not in model groups)
        fields:
          # Temporary field (not saved to database)
          - send_welcome_email:
              type: checkbox
              label: Send welcome email
              default: true
              help: "Sends a welcome email to the new hire after onboarding completion"
          
          # Computed field
          - full_name:
              type: computed
              expression: "{{ first_name }} {{ last_name }}"
              readonly: true
          
          # Conditional field
          - work_visa_number:
              type: string
              label: Work Visa Number
              visible_if:
                field: nationality
                operator: not_equals
                value: "US Citizen"
              validation: required_if:nationality,!US Citizen
        
        # Conditional step (skip based on previous data)
        condition:
          field: employment_type
          operator: in
          value: ["Full-time", "Part-time"]
      
      # Step 2: Job and employment details
      - title: Job Details
        description: Position, department, and employment information
        model: App\Modules\Hr\Models\EmployeePosition
        groups: [job_information, employment_details]
        
        validation:
          fields:
            job_title_id: required
            department_id: required
            base_salary: "required_if:employment_type,Full-time|min:0"
            start_date: required|date
        
        # Inline fields for wizard-specific logic
        fields:
          - skip_background_check:
              type: boolean
              label: Skip background check
              default: false
              help: "Only check this for internal transfers or contractors"
          
          # File upload field (wizard-specific)
          - job_description_file:
              type: file
              label: Job Description Document
              fileTypes: [pdf, doc, docx]
              maxSizeMB: 5
              validation: "mimes:pdf,doc,docx|max:5120"
      
      # Step 3: Extended personal and emergency info
      - title: Emergency & ID Info
        description: Emergency contacts and identification documents
        model: App\Modules\Hr\Models\EmployeeProfile
        groups: [emergency_contact, identification_documents]
        
        validation:
          required: false  # Optional step
        
        condition:
          field: employee.employment_type
          operator: equals
          value: "Full-time"
      
      # Step 4: Document uploads
      - title: Document Upload
        description: Required legal and employment documents
        model: App\Modules\Hr\Models\Document
        groups: [document_details]
        
        validation:
          minDocuments: 2  # Require at least 2 documents
          maxDocuments: 10
        
        # Dynamic fields based on document type
        fields:
          - document_type:
              type: select
              label: Document Type
              options:
                contract: Employment Contract
                id_proof: ID Proof
                visa: Work Visa
                certificate: Professional Certificate
                other: Other
          
          - document_file:
              type: file
              label: Upload Document
              validation: "required|mimes:pdf,jpg,jpeg,png|max:10240"
              maxSizeMB: 10
      
      # Step 5: Review and confirm (no model - review step)
      - title: Review & Confirm
        description: Please review all information before finalizing
        model: null  # No database model - review step only
        
        fields:
          - confirmation:
              type: checkbox
              label: "I confirm that all information provided is accurate and complete"
              validation: required
              required: true
          
          - manager_approval:
              type: select
              label: Manager Approval
              options_from: App\Modules\Hr\Models\Employee
              display_field: full_name
              where:
                department_id: "{{ employee.department_id }}"
                status: Active
              validation: required

    # Optional: Custom CSS classes for styling
    cssClasses:
      container: "wizard-onboarding"
      step: "wizard-step"
      navigation: "wizard-nav"
    
    # Optional: Custom JavaScript initialization
    scripts:
      - /js/wizards/employee-onboarding.js